controls.

csharp

Verify

Open In Editor
Edit
Copy code
using System.Windows;

namespace PatientApp
{
    public partial class MainWindow : Window
    {
        private PatientViewModel _viewModel;

        public MainWindow()
        {
            InitializeComponent();
            _viewModel = new PatientViewModel();
        }

        private void btnRegistration_Click(object sender, RoutedEventArgs e)
        {
            var patientRegControl = new PatientRegControl(_viewModel);
            patientRegControl.RegistrationCompleted += () => MainContent.Content = null;
            patientRegControl.NavigateToAppointment += () => 
            {
                var appointmentControl = new AppointmentConfirmationControl(_viewModel);
                appointmentControl.AppointmentCompleted += () => MainContent.Content = null;
                MainContent.Content = appointmentControl;
            };
            MainContent.Content = patientRegControl;
        }

        private void btnAppointment_Click(object sender, RoutedEventArgs e)
        {
            var appointmentConfirmationControl = new AppointmentConfirmationControl(_viewModel);
            appointmentConfirmationControl.AppointmentCompleted += () => MainContent.Content = null;
            MainContent.Content = appointmentConfirmationControl;
        }

        private void btnDashboard_Click(object sender, RoutedEventArgs e)
        {
            var patientDashboardControl = new PatientDashboardControl(_viewModel);
            MainContent.Content = patientDashboardControl;
        }
    }
}
3. PatientRegControl.xaml.cs
Ensure that the registration button click event is handled correctly.

csharp

Verify

Open In Editor
Edit
Copy code
using System;
using System.Windows;
using System.Windows.Controls;

namespace PatientApp
{
    public partial class PatientRegControl : UserControl
    {
        private PatientViewModel _viewModel;
        public event Action NavigateToAppointment;
        public event Action RegistrationCompleted;

        public PatientRegControl(PatientViewModel viewModel)
        {
            InitializeComponent();
            _viewModel = viewModel;
        }

        private void btnRegister_Click(object sender, RoutedEventArgs e)
        {
            var patient = new Patient
            {
                Name = NameTextBox.Text,
                Age = int.Parse(AgeTextBox.Text),
                DateOfBirth = DOBPicker.SelectedDate.Value,
                Address = AddressTextBox.Text,
                Slot = (SlotComboBox.SelectedItem as ComboBoxItem)?.Content.ToString(),
                BookingDate = DateTime.Now
            };
            _viewModel.RegisterPatient(patient);
            MessageBox.Show("Patient Details entered Successfully");
            RegistrationCompleted?.Invoke();
            NavigateToAppointment?.Invoke();
        }
    }
}
4. AppointmentConfirmationControl.xaml.cs
Ensure that the confirmation button click event is handled correctly.

csharp

Verify

Open In Editor
Edit
Copy code
using System;
using System.Collections.Generic;
using System.Windows;
using System.Windows.Controls;

namespace PatientApp
{
    public partial class AppointmentConfirmationControl : UserControl
    {
        private PatientViewModel _viewModel;
        public event Action NavigateToDashboard;
        public event Action AppointmentCompleted;

        public AppointmentConfirmationControl(PatientViewModel viewModel)
        {
            InitializeComponent();
            _viewModel = viewModel;
            LoadPatients();
        }

        private void LoadPatients()
        {
            foreach (var patient in _viewModel.Patients)
            {
                var checkBox = new CheckBox
                {
                    Content = $"{patient.Name} (Age: {patient.Age}, DOB: {patient.DateOfBirth.ToShortDateString()}, Address: {patient.Address})",
                    Tag = patient
                };
                PatientsListBox.Items.Add(checkBox);
            }
        }

        private void btnConfirm_Click(object sender, RoutedEventArgs e)
        {
            var selectedPatients = new List<Patient>();
            for (int i = PatientsListBox.Items.Count - 1; i >= 0; i--)
            {
                CheckBox checkBox = PatientsListBox.Items[i] as CheckBox;
                if (checkBox != null && checkBox.IsChecked == true && checkBox.Tag is Patient patient)
                {
                    selectedPatients.Add(patient);
                    PatientsListBox.Items.RemoveAt(i);
                }
            }

            foreach (var confirmedPatient in selectedPatients)
            {
                _viewModel.Patients.Remove(confirmedPatient);
            }

            _viewModel.ConfirmPatients(selectedPatients);
            MessageBox.Show("Appointment confirmed successfully.");
            AppointmentCompleted?.Invoke();
            NavigateToDashboard?.Invoke();
        }
    }
}
5. PatientDashboardControl.xaml.cs
Ensure that the dashboard displays the confirmed patients correctly.

csharp

Verify

Open In Editor
Edit
Copy code
using System;
using System.Windows;
using System.Windows.Controls;

namespace PatientApp
{
    public partial class PatientDashboardControl : UserControl
    {
        private PatientViewModel _viewModel;

        public PatientDashboardControl(PatientViewModel viewModel)
        {
            InitializeComponent();
            _viewModel = viewModel;
            DataContext = _viewModel;
            grdPatients.ItemsSource = _viewModel.ConfirmedPatients;
        }
    }
}
