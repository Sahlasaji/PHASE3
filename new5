using System;
using System.ComponentModel;

namespace PatientApp
{
    public class PatientRegViewModel : INotifyPropertyChanged
    {
        private PatientViewModel _mainViewModel;

        private string _name;
        private int _age;
        private string _dateOfBirth;
        private string _address;
        private string _slot;
        private DateTime? _bookingDate;

        public string Name
        {
            get => _name;
            set
            {
                _name = value;
                OnPropertyChanged(nameof(Name));
            }
        }

        public int Age
        {
            get => _age;
            set
            {
                _age = value;
                OnPropertyChanged(nameof(Age));
            }
        }

        public string DateOfBirth
        {
            get => _dateOfBirth;
            set
            {
                _dateOfBirth = value;
                OnPropertyChanged(nameof(DateOfBirth));
            }
        }

        public string Address
        {
            get => _address;
            set
            {
                _address = value;
                OnPropertyChanged(nameof(Address));
            }
        }

        public string Slot
        {
            get => _slot;
            set
            {
                _slot = value;
                OnPropertyChanged(nameof(Slot));
            }
        }

        public DateTime? BookingDate
        {
            get => _bookingDate;
            set
            {
                _bookingDate = value;
                OnPropertyChanged(nameof(BookingDate));
            }
        }

        public PatientRegViewModel(PatientViewModel mainViewModel)
        {
            _mainViewModel = mainViewModel;
        }

        public void RegisterPatient()
        {
            var patient = new Patient
            {
                Name = Name,
                Age = Age,
                DateOfBirth = DateOfBirth,
                Address = Address,
                Slot = Slot,
                BookingDate = BookingDate?.ToString("yyyy-MM-dd")
            };

            _mainViewModel.RegisterPatient(patient);
        }

        public event PropertyChangedEventHandler PropertyChanged;
        protected void OnPropertyChanged(string propertyName)
        {
            PropertyChanged?.Invoke(this, new PropertyChangedEventArgs(propertyName));
        }
    }
}
